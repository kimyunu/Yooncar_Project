<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>âš  EXTREME SYSTEM COMPROMISE âš </title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/terminal.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/flicker.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/simulation.css') }}" />
  <script src="{{ url_for('static', filename='js/enhanced_logs.js') }}"></script>
  <script src="{{ url_for('static', filename='js/simulation_overlay.js') }}"></script>
</head>
<body onload="initEnhancedSummary()">
  <!-- ìƒë‹¨ Plain-Language ì„¤ëª… íŒ¨ë„ -->
  <div class="alert-panel">
    <p>ğŸ›‘[ìœ„í—˜ ë‹¨ê³„ ìµœê³ ] ë°°í„°ë¦¬ ì—´í­ì£¼ ì§ì „! ê³§ í­ë°œ ì˜ˆìƒ.</p>
  </div>

  <!-- ì˜¤ë¥¸ìª½ í•˜ë‹¨ Summary ìš”ì•½ íŒ¨ë„ -->
  <div id="summary-panel" class="summary-panel"></div>

  <!-- í„°ë¯¸ë„ì²˜ëŸ¼ íƒ€ì´í•‘ë˜ëŠ” ì‹¬í™” í•´í‚¹ ë¡œê·¸ -->
  <pre id="enhanced-log-output"></pre>

  <!-- Tech-Logì™€ í•¨ê»˜ ì‹¤ì‹œê°„ CPU/Battery Temp ê·¸ë˜í”„ ì˜ì—­ -->
  <div class="stats-container">
    <div class="stat-box">
      <h3>CPU LOAD</h3>
      <div class="bar-graph">
        <div class="bar-fill" id="cpu-bar"></div>
      </div>
      <p id="cpu-percent" style="color: #FF0000; font-weight: bold;">--%</p>
    </div>
    <div class="stat-box">
      <h3>BATTERY TEMP</h3>
      <div class="bar-graph">
        <div class="bar-fill" id="bat-bar"></div>
      </div>
      <p id="bat-temp" style="color: #FF0000; font-weight: bold;">--Â°C</p>
    </div>
    <div class="stat-box">
      <h3>CAMERA FEED</h3>
      <p style="color: #888;">Feed Lost</p>
    </div>
  </div>

  <script>
    // ë¡œê·¸ ì¶œë ¥ ì™„ë£Œ í›„ 15ì´ˆ ë’¤ í­ë°œìŒ ì¬ìƒ â†’ ì‚¬ê³  í™”ë©´ìœ¼ë¡œ ì´ë™
    startEnhancedLog(() => {
      setTimeout(() => {
        const explosion = new Audio("{{ url_for('static', filename='assets/explosion_sound.mp3') }}");
        explosion.play();
        setTimeout(() => {
          window.location.href = "/accident";
        }, 3000);
      }, 15000);
    });

    // CPU, BATTERY TEMP ê·¸ë˜í”„ ì• ë‹ˆë©”ì´ì…˜ + ìˆ«ì í‘œì‹œ
    function animateStats() {
      const cpuBar = document.getElementById('cpu-bar');
      const batBar = document.getElementById('bat-bar');
      const cpuPercent = document.getElementById('cpu-percent');
      const batTemp = document.getElementById('bat-temp');

      // 2050ë…„í˜• ê³ ì„±ëŠ¥ CPU ë¡œë“œ: 90~100%
      const cpuVal = Math.floor(Math.random() * 10 + 90);
      // ë°°í„°ë¦¬ ì˜¨ë„: 120~150Â°C ê·¹í•œ ìƒíƒœ
      const batVal = Math.floor(Math.random() * 30 + 120);

      cpuBar.style.height = cpuVal + '%';
      cpuPercent.textContent = cpuVal + '%';

      // ë°°í„°ë¦¬ Temp ê·¸ë˜í”„: 200px ê¸°ì¤€ìœ¼ë¡œ 0~200Â°C ë§¤í•‘
      const mappedHeight = Math.min((batVal / 200) * 100, 100);
      batBar.style.height = mappedHeight + '%';
      batTemp.textContent = batVal + 'Â°C';

      setTimeout(animateStats, 1000);
    }
    animateStats();
  </script>
</body>
</html>
